# PowerSimData
This package enables communication with the server to carry out power-flow study
in the U.S. electrical grid. State pattern is used to alter the behavior of the
 *Scenario* object when its internal state changes. The following state have
 been implemented so far:
* **create**;
* **execute**;
* **analyze**;
* **delete**.

When a *Scenario* object is created, its state is set either to **create**,
**execute** or **analyze**. This is handled in the constructor of the *Scenario*
class. Only one argument is required to instantiate a *Scenario* object: the
`descriptor` (type `str`) of the scenario, which can either be the scenario id
or name. An empty `str` sets the *Scenario* in the **create** state. A valid
scenario id or name activates the **analyze** state if the simulation has
been successfully ran and the output data have been extracted. Otherwise the
**execute** state is selected.

Once the scenario is created, the internal state of the *Scenario* object is
automatically changed to **execute**. The later state does the heavy lifting: i)
it prepares the simulation inputs, ii) launches the simulation and iii) converts
the MATLAB binaries output files generated by MATPOWER to data frames saved as
Python pickle file. When this is done, the user can activate the **analyze**
state an download input (grid and various profiles used in the simulation) and
output data (power produced by generators and flowing in the branches of the
network). The **delete** state is only accessible from the **analyze** state and
lets the user delete the current scenario, i.e., input and out output data as
well as all references to the scenario in master files.



## 1. *Scenario* Object
This section illustrates the functionalities of the *Scenario* object.


### A. Analyzing Scenario
The following code snippet shows how one can access scenario information and
data using the *Scenario* object. 
```python
from powersimdata.scenario.scenario import Scenario

scenario = Scenario('0')
print(scenario.state.name)  # print name of Scenario object state

scenario.state.print_scenario_info()  # print scenario information
scenario.state.print_infeasibilities()  # print eventual infeasibilities

ct = scenario.state.get_ct  # get change table
grid = scenario.state.get_grid()  # get grid

demand = scenario.state.get_demand()  # get demand profile
hydro = scenario.state.get_hydro()  # get hydro profile
solar = scenario.state.get_solar()  # get solar profile
wind = scenario.state.get_wind()  # get wind profile

pg = scenario.state.get_pg()  # get PG profile
pf = scenario.state.get_pf()  # get PF profile
```
If the capacity of some generators, branches or DC line have been increased
and/or the demand in one or multiple load zones has been scaled for this
scenario then the change table will enclose these changes and the retrieved
grid and input profiles will be modified accordingly.


### B. Creating Scenario
A scenario can be created using few lines of code. This is illustrated below:
```python
from powersimdata.scenario.scenario import Scenario

scenario = Scenario('')
print(scenario.state.name)  # print name of Scenario object state


scenario.state.set_builder(['Western'])  # set interconnection

scenario.state.builder.set_name('test', 'dummy')  # set plan and scenario names
scenario.state.builder.set_time('2016-08-01 00:00:00', '2016-08-31 23:00:00',
                                '124H')  # set start date, end date and interval
scenario.state.builder.set_base_profile('demand', 'v3')  # set demand
scenario.state.builder.set_base_profile('hydro', 'v1')  # set hydro
scenario.state.builder.set_base_profile('solar', 'v2')  # set solar
scenario.state.builder.set_base_profile('wind', 'v1')  # set wind

# scale capacity of solar plants in WA and AZ by 5 and 2.5, respectively
scenario.state.builder.change_table.scale_plant_capacity('solar',
                                                         zone={'Washington': 5,
                                                               'Arizona': 2.5})
# scale capacity of wind farms in OR and MT by 1.5 and 2, respectively
scenario.state.builder.change_table.scale_plant_capacity('wind',
                                                         zone={'Oregon': 1.5,
                                                               'Montana': 2})
# scale capacity of solar plants in NV and WY by 2
scenario.state.builder.change_table.scale_branch_capacity(zone={'Nevada': 2,
                                                                'Wyoming': 2})
print(scenario.state.builder.change_table.ct)  # print change table

###################
# Create scenario #
###################
scenario.state.print_scenario_info()  # review information
scenario.state.create_scenario()  # create
print(scenario.state.name)  # print name of Scenario object state
print(scenario.state.print_scenario_status())  # print status of scenario
```


### C. Executing Scenario
